@using Dotnet9.Tools.Web.Models
@using Newtonsoft.Json
<MList Subheader TwoLine Dense>

    <MSubheader Inset>@T("Tools")</MSubheader>

    @if (_toolItems != null)
    {
        foreach (var item in _toolItems)
        {
            <MListItem Link Href="@item.Url">
                <MListItemAvatar>
                    <MIcon Class="amber" Dark>mdi-gesture-tap-button</MIcon>
                </MListItemAvatar>

                <MListItemContent>
                    <MListItemTitle>@item.Name</MListItemTitle>
                </MListItemContent>
            </MListItem>
        }
    }


    <MDivider Inset></MDivider>
    <MSubheader Inset>@T("Album")</MSubheader>

    @foreach (var item in ConstDatas.AlbumTreeItems)
    {
        <MListItem Link Href="@($"/album/{item.Slug}")">
            <MListItemAvatar>
                <MIcon Class="orange" Dark>mdi-clipboard-text</MIcon>
            </MListItemAvatar>

            <MListItemContent>
                <MListItemTitle>@item.Name</MListItemTitle>
            </MListItemContent>
        </MListItem>
    }

    <MDivider Inset></MDivider>
    <MSubheader Inset>@T("Blog")</MSubheader>

    @foreach (var item in ConstDatas.CategoryNotTreeItems)
    {
        <MListItem Link Href="@($"/cat/{item.Slug}")">
            <MListItemAvatar>
                <MIcon Class="blue" Dark>mdi-clipboard-text</MIcon>
            </MListItemAvatar>

            <MListItemContent>
                <MListItemTitle>@item.Name</MListItemTitle>
            </MListItemContent>
        </MListItem>
    }
</MList>

@code
{
    private List<ToolItem>? _toolItems;

    [CascadingParameter]
    public PublicLayout? MainLayout { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var toolJson = await File.ReadAllTextAsync(Path.Combine("wwwroot", "tool.json"));
        _toolItems = JsonConvert.DeserializeObject<List<ToolItem>>(toolJson);

        await base.OnInitializedAsync();
    }

    public string T(string key)
    {
        return MainLayout?.T(key) ?? string.Empty;
    }
}